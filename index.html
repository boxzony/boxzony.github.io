<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Battery Design & Processing Lab | DGIST</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #111111; color: #E5E7EB; }
        .font-hero { font-family: 'Poppins', sans-serif; font-weight: 300; }
        .accent-yellow { color: #FFC000; }
        .bg-accent-yellow { background-color: #FFC000; }
        .border-accent-yellow { border-color: #FFC000; }
        .nav-link { position: relative; transition: color 0.3s ease; }
        .nav-link::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -4px; left: 50%; transform: translateX(-50%); background-color: #FFC000; transition: width 0.3s ease; }
        .nav-link:hover::after, .nav-link.active::after { width: 100%; }
        .nav-link.active { color: #FFC000; }
        .dropdown { position: relative; display: inline-block; }
        .dropdown-content { display: none; position: absolute; background-color: #1f1f1f; min-width: 160px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 1; border-radius: 0.5rem; border: 1px solid #333; padding: 0.5rem 0; }
        .dropdown-content a { color: #E5E7EB; padding: 12px 16px; text-decoration: none; display: block; transition: background-color 0.2s; }
        .dropdown-content a:hover { background-color: #333; color: #FFC000; }
        .dropdown:hover .dropdown-content { display: block; }
        .content-section { display: none; animation: fadeIn 0.8s; }
        .content-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #2d2d2d; }
        ::-webkit-scrollbar-thumb { background: #FFC000; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #e6ad00; }
        .card { background-color: #1f1f1f; border: 1px solid #333; transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(255, 192, 0, 0.1); }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out; }
        .admin-controls { display: none; }
        body.admin-mode .admin-controls { display: flex; }
        .slider { position: relative; }
        .slider-img { display: none; }
        .slider-img.active { display: block; }
        .slider-btn { position: absolute; top: 50%; transform: translateY(-50%); background-color: rgba(0,0,0,0.5); color: white; border: none; padding: 0.5rem; cursor: pointer; z-index: 10; }
        .slider-btn.prev { left: 10px; }
        .slider-btn.next { right: 10px; }
    </style>
</head>
<body class="antialiased">

    <!-- Header -->
    <header id="header" class="bg-black/80 backdrop-blur-sm sticky top-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <a href="#" class="flex items-center space-x-2" onclick="showSection('home', this)"><img src="https://storage.googleapis.com/gemini-prod/images/f69ab641-75be-46b6-802e-c54a2f77cc54" alt="BDPL Logo" class="h-12"></a>
                <nav class="hidden md:flex items-center space-x-8">
                    <a href="#" class="nav-link text-gray-300 hover:text-accent-yellow" onclick="showSection('philosophy', this)">PHILOSOPHY</a>
                    <a href="#" class="nav-link text-gray-300 hover:text-accent-yellow" onclick="showSection('team', this)">TEAM</a>
                    <a href="#" class="nav-link text-gray-300 hover:text-accent-yellow" onclick="showSection('resources', this)">RESOURCES</a>
                    <div class="dropdown"><a href="#" class="nav-link text-gray-300 hover:text-accent-yellow">ARCHIVES</a><div class="dropdown-content"><a href="#" onclick="showSection('notices', this, true)">Notices</a><a href="#" onclick="showSection('news', this, true)">News</a><a href="#" onclick="showSection('memories', this, true)">Memories</a></div></div>
                    <div class="dropdown"><a href="#" class="nav-link text-gray-300 hover:text-accent-yellow">RESEARCH</a><div class="dropdown-content"><a href="#" onclick="showSection('themes', this, true)">Themes</a><a href="#" onclick="showSection('articles', this, true)">Articles</a><a href="#" onclick="showSection('patents', this, true)">Patents</a><a href="#" onclick="showSection('presentations', this, true)">Presentations</a></div></div>
                </nav>
                <div class="md:hidden"><button id="mobile-menu-button" class="text-gray-300 hover:text-accent-yellow focus:outline-none"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg></button></div>
            </div>
        </div>
        <div id="mobile-menu" class="md:hidden hidden bg-black/90"></div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <section id="home" class="content-section active">
            <div class="min-h-[calc(80vh-10rem)] flex flex-col justify-center text-center"><h1 class="text-4xl md:text-6xl font-hero tracking-tight text-white leading-tight">NEXT-GENERATION BATTERIES BY<br><span class="accent-yellow">ENGINEERED SCIENCE</span></h1><p class="mt-6 text-lg md:text-xl text-gray-400 max-w-3xl mx-auto">Innovative multiscale structural design and processing technologies toward sustainable and efficient energy storage solutions.</p><div class="mt-10"><a href="#" class="inline-block bg-transparent border-2 border-accent-yellow text-accent-yellow font-semibold py-3 px-8 rounded-md hover:bg-accent-yellow hover:text-black transition-all duration-300" onclick="showSection('themes', this, true)">Explore Our Research</a></div></div>
            <div class="mt-16 grid md:grid-cols-2 gap-8"><div><h2 class="text-2xl font-bold mb-4">Latest News</h2><div id="home-news-list" class="space-y-3"></div></div><div><h2 class="text-2xl font-bold mb-4">Recent Notices</h2><div id="home-notices-list" class="space-y-3"></div></div></div>
        </section>
        <section id="philosophy" class="content-section"><h2 class="text-3xl font-bold text-center mb-12">Our Philosophy</h2><div id="philosophy-list" class="space-y-4 max-w-4xl mx-auto"></div></section>
        <section id="team" class="content-section">
            <h2 class="text-3xl font-bold text-center mb-12">Our Team</h2>
            <div id="leader-section" class="mb-16"></div>
            <div class="mb-16"><div class="flex justify-between items-center mb-8"><h3 class="text-2xl font-semibold accent-yellow">Members</h3><button onclick="openItemModal('members')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors text-sm">Add Member</button></div><div id="members-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8"></div></div>
            <div class="mb-16"><div class="flex justify-between items-center mb-8"><h3 class="text-2xl font-semibold accent-yellow">Alumni</h3><button onclick="openItemModal('alumni')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors text-sm">Add Alumni</button></div><div id="alumni-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8"></div></div>
            <div id="recruitment-section"></div>
        </section>
        <section id="resources" class="content-section"><h2 class="text-3xl font-bold text-center mb-12">Resources</h2><div class="space-y-16"><div><div class="flex justify-between items-center mb-8"><h3 class="text-2xl font-semibold accent-yellow">Projects</h3><button onclick="openItemModal('projects')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors text-sm">Add New Project</button></div><div id="projects-list" class="card overflow-x-auto rounded-lg p-4"></div></div><div><div class="flex justify-between items-center mb-8"><h3 class="text-2xl font-semibold accent-yellow">Hardware</h3><button onclick="openItemModal('hardware')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors text-sm">Add New Hardware</button></div><div id="hardware-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div></div><div><div class="flex justify-between items-center mb-8"><h3 class="text-2xl font-semibold accent-yellow">Software</h3><button onclick="openItemModal('software')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors text-sm">Add New Software</button></div><div id="software-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div></div><div><div class="flex justify-between items-center mb-8"><h3 class="text-2xl font-semibold accent-yellow">Algorithm</h3><button onclick="openItemModal('algorithm')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors text-sm">Add New Algorithm</button></div><div id="algorithm-list" class="space-y-4"></div></div></div></section>
        <section id="notices" class="content-section"><div class="flex justify-between items-center mb-8"><h2 class="text-3xl font-bold">Notices</h2><button onclick="openItemModal('notices')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors">Write New Post</button></div><div id="notices-list" class="space-y-4"></div></section>
        <section id="news" class="content-section"><div class="flex justify-between items-center mb-8"><h2 class="text-3xl font-bold">News</h2><button onclick="openItemModal('news')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors">Write New Post</button></div><div id="news-list" class="space-y-4"></div></section>
        <section id="memories" class="content-section"><div class="flex justify-between items-center mb-8"><h2 class="text-3xl font-bold">Memories</h2><button onclick="openItemModal('memories')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors">Write New Post</button></div><div id="memories-list" class="space-y-4"></div></section>
        <section id="themes" class="content-section"><div class="flex justify-between items-center mb-8"><h2 class="text-3xl font-bold">Research Themes</h2><button onclick="openItemModal('themes')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors">Add New Theme</button></div><div id="themes-list" class="space-y-4 max-w-5xl mx-auto"></div></section>
        <section id="articles" class="content-section"><div class="flex justify-between items-center mb-8"><h2 class="text-3xl font-bold">Publications</h2><button onclick="openItemModal('articles')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors">Add New Article</button></div><div id="articles-list" class="card p-6 rounded-lg space-y-6 max-w-4xl mx-auto"></div></section>
        <section id="patents" class="content-section"><div class="flex justify-between items-center mb-8"><h2 class="text-3xl font-bold">Patents</h2><button onclick="openItemModal('patents')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors">Add New Patent</button></div><div id="patents-list" class="card p-6 rounded-lg space-y-6 max-w-4xl mx-auto"></div></section>
        <section id="presentations" class="content-section"><div class="flex justify-between items-center mb-8"><h2 class="text-3xl font-bold">Presentations</h2><button onclick="openItemModal('presentations')" class="admin-controls bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors">Add New Presentation</button></div><div id="presentations-list" class="card p-6 rounded-lg space-y-6 max-w-4xl mx-auto"></div></section>
    </main>
    
    <!-- Modals -->
    <div id="item-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden p-4"><div class="card p-8 rounded-lg w-full max-w-2xl max-h-full overflow-y-auto"><h3 class="text-2xl font-bold mb-4" id="item-modal-title"></h3><input type="hidden" id="item-category"><input type="hidden" id="item-id"><div id="item-form-fields" class="space-y-4"></div><div class="mt-6 flex justify-end space-x-4"><button onclick="closeItemModal()" class="bg-gray-600 text-white font-semibold py-2 px-4 rounded-md hover:bg-gray-500 transition-colors">Cancel</button><button onclick="saveItem()" class="bg-accent-yellow text-black font-semibold py-2 px-4 rounded-md hover:bg-yellow-400 transition-colors">Save</button></div></div></div>
    <div id="view-item-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden p-4"><div class="card p-8 rounded-lg w-full max-w-3xl max-h-full overflow-y-auto relative"><button onclick="closeViewItemModal()" class="absolute top-4 right-4 text-gray-500 hover:text-white text-3xl">&times;</button><div id="view-item-content"></div></div></div>
    <div id="confirm-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden p-4"><div class="card p-8 rounded-lg w-full max-w-sm text-center"><h3 class="text-lg font-bold mb-4">Are you sure?</h3><p class="text-gray-400 mb-6">This action cannot be undone.</p><div class="flex justify-center space-x-4"><button id="confirm-cancel" class="bg-gray-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-gray-500">Cancel</button><button id="confirm-delete" class="bg-red-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-red-500">Delete</button></div></div></div>

    <footer class="bg-black border-t border-gray-800 mt-16"><div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 text-center text-gray-500 text-sm"><p>&copy; <span id="copyright-year" class="cursor-pointer"></span> Battery Design & Processing Lab. All rights reserved.</p></div></footer>

    <script>
        // --- Globals & State ---
        let appData = {};

        // --- Initial Data ---
        const initialData = {
            leader: [{ id: 'leader_1', name: 'Jinsoo Kim, Ph.D.', title: 'Assistant Professor', department: 'Department of Energy Science and Engineering, DGIST', education: 'Ph.D., Materials Science and Engineering, Seoul National University', image: ['https://storage.googleapis.com/gemini-prod/images/d88273b4-d3fb-4652-9943-8fb4fa553d16'], email: 'jinsoo.kim@dgist.ac.kr', scholar: 'https://scholar.google.com/citations?user=PLEASE_ADD_YOUR_GOOGLE_SCHOLAR_ID' }],
            members: [{ id: 'member_1', name: 'Member Name', status: 'Ph.D. Candidate', joined: 'Fall 2025', school: 'B.S. from [University Name]', image: ['https://placehold.co/200x200/333333/e0e0e0?text=Photo'], bio: 'Researching next-generation anode materials.' }],
            alumni: [{ id: 'alumni_1', name: 'Alumni Name', period: '2026 - 2028', current: 'Current: [Company/Institution]', image: ['https://placehold.co/200x200/333333/e0e0e0?text=Photo'] }],
            recruitment: [{ id: 'recruitment_1', title: 'Recruitment', content: 'We are actively looking for passionate and self-motivated graduate students and researchers to join our team.', positions: 'Ph.D. (1), M.S. (2)', contact: 'Interested candidates should send their CV, academic transcripts, and a brief statement of research interests to Prof. Jinsoo Kim at <a href="mailto:jinsoo.kim@dgist.ac.kr" class="text-accent-yellow hover:underline">jinsoo.kim@dgist.ac.kr</a>.' }],
            philosophy: [
                { id: 'philo_1', title: 'Mission', icon: '<svg class="w-8 h-8 mr-4 accent-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>', content: '<b class="text-gray-300">To bridge the gap</b> between fundamental science and industrial application by developing <b class="text-gray-300">scalable, high-impact</b> battery technologies.' },
                { id: 'philo_2', title: 'Vision', icon: '<svg class="w-8 h-8 mr-4 accent-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>', content: '<b class="text-gray-300">To be a world-leading laboratory</b> that pioneers novel battery structures and design methodologies to solve <b class="text-gray-300">critical energy challenges.</b>' },
                { id: 'philo_3', title: 'Value', icon: '<svg class="w-8 h-8 mr-4 accent-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.085a2 2 0 00-1.736.97l-2.714 4.222a2 2 0 00.175 2.572l3.5 3.5a2 2 0 002.828 0l-3.5-3.5m7 10h4.764a2 2 0 001.789-2.894l-3.5-7a2 2 0 00-1.789-1.106h-4.017a2 2 0 00-1.966 2.37l1.5 6A2 2 0 0015.263 21z"></path></svg>', content: 'We are committed to <b class="text-gray-300">practical engineering</b>, rigorous scientific inquiry, and <b class="text-gray-300">collaborative innovation</b> to achieve tangible impact.' },
                { id: 'philo_4', title: 'Principle', icon: '<svg class="w-8 h-8 mr-4 accent-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M12 6V4m0 16v-2M8 8l1.414-1.414M14.586 14.586L16 16m-1.414-9.172L16 5.414M5.414 16L4 14.586M12 12a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>', content: 'Guided by <b class="text-gray-300">"Engineered Science"</b> — using practical challenges to inspire fundamental questions, ensuring our work is <b class="text-gray-300">relevant and innovative.</b>' }
            ],
            themes: [
                { id: 'theme_1', title: '1. Diffusion-Stabilizing Hierarchical Electrode Design', image: ['https://storage.googleapis.com/gemini-prod/images/41834988-c71d-4054-9549-c186064f331f'], content: 'We design multi-layered and functionally graded electrode architectures to manage ion transport and reaction kinetics.'},
                { id: 'theme_2', title: '2. Advanced Processing for Innovative Electrode Structures', image: ['https://storage.googleapis.com/gemini-prod/images/5f04b2b2-6580-4927-a9a7-285038c1a84f'], content: 'Our lab focuses on developing and optimizing innovative manufacturing processes, particularly solvent-free dry coating technology.'},
            ],
            articles: [{ id: 'article_1', title: 'Advanced parametrization for the production of high-energy solid-state lithium pouch cells', authors: 'W Lee, J Lee, T Yu, ... J Kim*', journal: 'Nature Communications, 15, 5860 (2024)', url: 'https://www.nature.com/articles/s41467-024-49298-y' }],
            notices: [{ id: 'notice_1', title: '[2025-08-15] Weekly Meeting', content: 'The weekly group meeting schedule has been updated.', image: [] }],
            news: [{ id: 'news_1', title: '[2025-07-20] Paper Accepted!', content: 'Congratulations! Our paper on dry electrodes was accepted by Nature Communications!', image: ['https://placehold.co/800x600/1f1f1f/FFC000?text=Celebration'] }],
            projects: [{ id: 'project_1', sponsor: 'NST', name: 'Development of a continuous solvent-free innovative process', period: '2021-2026', budget: '₩4.85B', status: 'Ongoing' }],
            hardware: [{ id: 'hardware_1', name: 'Pouch Cell Assembly Line', manufacturer: '[Name]', acquired: '2025', image: ['https://placehold.co/600x400/333333/e0e0e0?text=Equipment'] }],
            software: [{ id: 'software_1', name: 'COMSOL Multiphysics', manufacturer: 'COMSOL Inc.', acquired: '2025', image: ['https://placehold.co/600x400/333333/e0e0e0?text=Software'] }],
            algorithm: [{ id: 'algo_1', title: 'Electrode Design Toolkit v1.0', content: 'A proprietary toolkit developed in-house for rapid prototyping and simulation of novel electrode architectures. Based on Python and leveraging machine learning models.', image: [] }]
        };

        // --- Navigation & Page Control ---
        function showSection(sectionId, clickedLink, isSubmenu = false) {
            if(event) event.preventDefault();
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            const targetSection = document.getElementById(sectionId);
            if (targetSection) targetSection.classList.add('active');
            else document.getElementById('home').classList.add('active');
            document.querySelectorAll('header nav .nav-link').forEach(l => l.classList.remove('active'));
            if (sectionId !== 'home') {
                const mainLink = isSubmenu ? clickedLink.closest('.dropdown')?.querySelector('.nav-link') : clickedLink;
                if(mainLink) mainLink.classList.add('active');
            }
            document.getElementById('mobile-menu').classList.add('hidden');
            window.scrollTo(0, 0);
        }
        
        function setupMobileMenu() {
            const desktopNav = document.querySelector('header nav');
            if (!desktopNav) return;
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.innerHTML = desktopNav.innerHTML;
            mobileMenu.querySelectorAll('.dropdown').forEach(d => {
                d.querySelector('a')?.addEventListener('click', e => e.preventDefault());
                const s = d.querySelector('.dropdown-content');
                if(s) { s.style.position = 'static'; s.style.display = 'block'; s.style.backgroundColor = 'transparent'; s.style.boxShadow = 'none'; s.style.border = 'none'; s.style.padding = '0 0 0 1rem'; }
            });
            mobileMenu.querySelectorAll('a').forEach(link => {
                const onclickAttr = link.getAttribute('onclick');
                link.removeAttribute('onclick');
                link.classList.remove('nav-link');
                link.classList.add('block', 'py-3', 'px-4', 'text-sm', 'text-gray-300', 'hover:bg-gray-800', 'hover:text-accent-yellow');
                link.addEventListener('click', () => {
                    if (onclickAttr) {
                        const match = onclickAttr.match(/showSection\('([^']*)', this, (true|false)?\)/);
                        if (match) showSection(match[1], link, match[2] === 'true');
                    }
                });
            });
        }
        document.getElementById('mobile-menu-button').addEventListener('click', () => document.getElementById('mobile-menu').classList.toggle('hidden'));

        // --- Admin Mode ---
        function handleAdminAccess() {
            if (document.body.classList.contains('admin-mode')) {
                document.body.classList.remove('admin-mode');
            } else {
                const password = prompt("관리자 비밀번호를 입력하세요:");
                if (password === "bdpladmin") {
                    document.body.classList.add('admin-mode');
                } else if (password !== null && password !== "") {
                    alert("비밀번호가 틀렸습니다.");
                }
            }
        }
        
        // --- Accordion ---
        function setupAccordions() {
            document.querySelectorAll('.accordion-toggle').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('svg:last-child');
                    if (content.style.maxHeight && content.style.maxHeight !== '0px') {
                        content.style.maxHeight = '0px';
                        if(icon) icon.style.transform = 'rotate(0deg)';
                    } else {
                        content.style.maxHeight = content.scrollHeight + "px";
                        if(icon) icon.style.transform = 'rotate(180deg)';
                    }
                });
            });
        }

        // --- Modals (CRUD & View) ---
        const itemModal = document.getElementById('item-modal');
        const viewItemModal = document.getElementById('view-item-modal');
        const confirmModal = document.getElementById('confirm-modal');
        const itemFormFields = document.getElementById('item-form-fields');
        const itemFieldsTemplates = {
            archives: `<input type="text" name="title" placeholder="Title" required><textarea name="content" placeholder="Content..." rows="5" required></textarea><div><label class="block text-sm font-medium text-gray-400 mb-2">Images</label><input type="file" name="image" accept="image/*" multiple></div>`,
            articles: `<input type="text" name="title" placeholder="Title" required><input type="text" name="authors" placeholder="Authors" required><input type="text" name="journal" placeholder="Journal, Vol, Page (YYYY)" required><input type="url" name="url" placeholder="URL Link">`,
            themes: `<input type="text" name="title" placeholder="Theme Title" required><textarea name="content" placeholder="Description..." rows="5" required></textarea><div><label class="block text-sm font-medium text-gray-400 mb-2">Images</label><input type="file" name="image" accept="image/*" multiple></div>`,
            leader: `<input type="text" name="name" placeholder="Name" required><input type="text" name="title" placeholder="Title" required><input type="text" name="department" placeholder="Department" required><input type="text" name="education" placeholder="Education" required><input type="email" name="email" placeholder="Email"><input type="url" name="scholar" placeholder="Google Scholar URL"><div><label class="block text-sm font-medium text-gray-400 mb-2">Image</label><input type="file" name="image" accept="image/*"></div>`,
            members: `<input type="text" name="name" placeholder="Name" required><input type="text" name="status" placeholder="Status (e.g., Ph.D. Candidate)" required><input type="text" name="joined" placeholder="Joined Date" required><input type="text" name="school" placeholder="Alma Mater" required><textarea name="bio" placeholder="Short Bio..." rows="3"></textarea><div><label class="block text-sm font-medium text-gray-400 mb-2">Image</label><input type="file" name="image" accept="image/*"></div>`,
            alumni: `<input type="text" name="name" placeholder="Name" required><input type="text" name="period" placeholder="Period (e.g., 2026-2028)" required><input type="text" name="current" placeholder="Current Position" required><div><label class="block text-sm font-medium text-gray-400 mb-2">Image</label><input type="file" name="image" accept="image/*"></div>`,
            recruitment: `<input type="text" name="title" placeholder="Title" required><textarea name="content" placeholder="Content..." rows="4" required></textarea><input type="text" name="positions" placeholder="Open Positions" required><textarea name="contact" placeholder="Contact Info..." rows="3" required></textarea>`,
            projects: `<input type="text" name="sponsor" placeholder="Sponsor" required><input type="text" name="name" placeholder="Project Name" required><input type="text" name="period" placeholder="Period" required><input type="text" name="budget" placeholder="Budget" required><select name="status"><option>Ongoing</option><option>Completed</option></select>`,
            hardware: `<input type="text" name="name" placeholder="Equipment Name" required><input type="text" name="manufacturer" placeholder="Manufacturer" required><input type="text" name="acquired" placeholder="Acquired Year" required><div><label class="block text-sm font-medium text-gray-400 mb-2">Images</label><input type="file" name="image" accept="image/*" multiple></div>`,
            software: `<input type="text" name="name" placeholder="Software Name" required><input type="text" name="manufacturer" placeholder="Manufacturer" required><input type="text" name="acquired" placeholder="Acquired Year" required><div><label class="block text-sm font-medium text-gray-400 mb-2">Images</label><input type="file" name="image" accept="image/*" multiple></div>`,
            algorithm: `<input type="text" name="title" placeholder="Algorithm/Toolkit Title" required><textarea name="content" placeholder="Description..." rows="5" required></textarea><div><label class="block text-sm font-medium text-gray-400 mb-2">Images</label><input type="file" name="image" accept="image/*" multiple></div>`
        };

        function openItemModal(category, id = null) {
            const isArchive = ['notices', 'news', 'memories'].includes(category);
            const formCategory = isArchive ? 'archives' : category;
            itemModal.querySelector('#item-category').value = category;
            itemModal.querySelector('#item-id').value = id || '';
            itemModal.querySelector('#item-modal-title').textContent = `${id ? 'Edit' : 'Add New'} ${category.charAt(0).toUpperCase() + category.slice(1)}`;
            itemFormFields.innerHTML = itemFieldsTemplates[formCategory];
            itemFormFields.querySelectorAll('input, textarea, select').forEach(el => el.classList.add('w-full', 'bg-gray-800', 'border', 'border-gray-700', 'rounded-md', 'p-2', 'text-white', 'focus:outline-none', 'focus:ring-2', 'focus:ring-accent-yellow'));
            if (id) {
                const item = appData[category].find(i => i.id === id);
                Object.keys(item).forEach(key => {
                    const input = itemFormFields.querySelector(`[name="${key}"]`);
                    if (input && input.type !== 'file') input.value = item[key];
                });
            }
            itemModal.classList.remove('hidden');
        }
        function closeItemModal() { itemModal.classList.add('hidden'); itemFormFields.innerHTML = ''; }

        async function saveItem() {
            const category = itemModal.querySelector('#item-category').value;
            const id = itemModal.querySelector('#item-id').value;
            const inputs = itemFormFields.querySelectorAll('input, textarea, select');
            const data = {};
            for (const input of inputs) {
                if (input.type === 'file') {
                    if (input.files.length > 0) {
                        data[input.name] = await Promise.all(Array.from(input.files).map(file => toBase64(file)));
                    }
                } else {
                    data[input.name] = input.value;
                }
            }
            
            if (id) {
                const index = appData[category].findIndex(i => i.id === id);
                if (data.image === undefined && appData[category][index]) {
                    data.image = appData[category][index].image;
                }
                appData[category][index] = { ...appData[category][index], ...data };
            } else {
                const newItem = { id: `${category}_${Date.now()}`, ...data };
                if (['members', 'alumni'].includes(category)) {
                    appData[category].push(newItem);
                } else {
                    appData[category].unshift(newItem);
                }
            }
            reRender(category);
            closeItemModal();
        }
        const toBase64 = file => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });

        function deleteItem(category, id) {
            confirmModal.classList.remove('hidden');
            document.getElementById('confirm-delete').onclick = () => {
                appData[category] = appData[category].filter(i => i.id !== id);
                reRender(category);
                confirmModal.classList.add('hidden');
            };
            document.getElementById('confirm-cancel').onclick = () => confirmModal.classList.add('hidden');
        }

        function viewItem(category, id) {
            const item = appData[category].find(i => i.id === id);
            if (!item) return;
            let contentHTML = '';
            if (category === 'members' || category === 'alumni') {
                contentHTML = `<div class="flex flex-col md:flex-row items-center gap-8"><img src="${item.image[0]}" alt="${item.name}" class="w-48 h-48 rounded-full object-cover border-4 border-gray-700"><div class="text-center md:text-left"><h4 class="text-2xl font-bold text-white">${item.name}</h4><p class="text-accent-yellow font-medium">${item.status || item.period}</p><p class="text-gray-400 mt-2">${item.school || item.current}</p><p class="text-gray-400 mt-4">${item.bio || ''}</p></div></div>`;
            } else {
                const images = item.image || [];
                const sliderId = `slider_${Date.now()}`;
                const sliderHTML = images.length > 0 ? `<div id="${sliderId}" class="slider relative my-4">${images.map((img, i) => `<img src="${img}" class="slider-img w-full rounded-md max-h-96 object-contain ${i === 0 ? 'active' : ''}">`).join('')}${images.length > 1 ? `<button class="slider-btn prev" onclick="changeSlide('${sliderId}', -1)">&#10094;</button><button class="slider-btn next" onclick="changeSlide('${sliderId}', 1)">&#10095;</button>` : ''}</div>` : '';
                contentHTML = `<h3 class="text-2xl font-bold mb-4">${item.title}</h3>${sliderHTML}<p class="text-gray-400 whitespace-pre-wrap">${item.content}</p>`;
            }
            document.getElementById('view-item-content').innerHTML = contentHTML;
            viewItemModal.classList.remove('hidden');
        }
        function closeViewItemModal() { viewItemModal.classList.add('hidden'); }
        
        function changeSlide(sliderId, n) {
            const slider = document.getElementById(sliderId);
            const slides = slider.querySelectorAll('.slider-img');
            let slideIndex = Array.from(slides).findIndex(slide => slide.classList.contains('active'));
            slides[slideIndex].classList.remove('active');
            slideIndex = (slideIndex + n + slides.length) % slides.length;
            slides[slideIndex].classList.add('active');
        }

        // --- Render Functions ---
        const renderFunctions = {
            leader: item => {
                document.getElementById('leader-section').innerHTML = `<div class="flex justify-between items-center mb-8"><h3 class="text-2xl font-semibold accent-yellow">Leader</h3><button onclick="openItemModal('leader', '${item.id}')" class="admin-controls bg-transparent text-gray-400 p-2 rounded-full hover:bg-gray-700"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"></path><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd"></path></svg></button></div><div class="card max-w-4xl mx-auto p-8 rounded-lg flex flex-col md:flex-row items-center gap-8"><img src="${item.image[0]}" alt="${item.name}" class="w-48 h-48 rounded-full object-cover border-4 border-gray-700"><div class="text-center md:text-left"><h4 class="text-2xl font-bold text-white">${item.name}</h4><p class="text-accent-yellow font-medium">${item.title}</p><p class="text-gray-400 mt-2">${item.department}</p><p class="text-gray-500 mt-4">${item.education}</p><div class="mt-4 flex justify-center md:justify-start space-x-4 text-gray-400"><a href="mailto:${item.email}" class="hover:text-accent-yellow">Email</a><span>|</span><a href="${item.scholar}" target="_blank" class="hover:text-accent-yellow">Google Scholar</a></div></div></div>`;
            },
            members: item => `<div class="card text-center p-6 rounded-lg relative group"><div class="absolute top-2 right-2 space-x-1 admin-controls"><button onclick="openItemModal('members', '${item.id}')" class="bg-gray-700 p-2 rounded-full hover:bg-accent-yellow text-white hover:text-black"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"></path><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd"></path></svg></button><button onclick="deleteItem('members', '${item.id}')" class="bg-gray-700 p-2 rounded-full hover:bg-red-500 text-white"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button></div><div class="cursor-pointer" onclick="viewItem('members', '${item.id}')"><img src="${item.image[0]}" alt="${item.name}" class="w-32 h-32 rounded-full mx-auto mb-4 border-4 border-gray-700"><h5 class="text-lg font-bold text-white">${item.name}</h5><p class="text-gray-400">${item.status}</p><p class="text-sm text-gray-500 mt-1">Joined: ${item.joined}</p><p class="text-sm text-gray-500">${item.school}</p></div></div>`,
            alumni: item => `<div class="card text-center p-6 rounded-lg relative group"><div class="absolute top-2 right-2 space-x-1 admin-controls"><button onclick="openItemModal('alumni', '${item.id}')" class="..."></button><button onclick="deleteItem('alumni', '${item.id}')" class="..."></button></div><div class="cursor-pointer" onclick="viewItem('alumni', '${item.id}')"><img src="${item.image[0]}" alt="${item.name}" class="w-32 h-32 rounded-full mx-auto mb-4 border-4 border-gray-700"><h5 class="text-lg font-bold text-white">${item.name}</h5><p class="text-gray-400">${item.period}</p><p class="text-sm text-gray-500 mt-1">${item.current}</p></div></div>`,
            recruitment: item => { document.getElementById('recruitment-section').innerHTML = `<div class="relative"><div class="absolute top-0 right-0 admin-controls"><button onclick="openItemModal('recruitment', '${item.id}')" class="..."></button></div><h3 class="text-2xl font-semibold text-center mb-8 accent-yellow">${item.title}</h3><div class="card max-w-3xl mx-auto p-8 rounded-lg text-center"><p class="text-lg text-gray-300 mb-4">${item.content}</p><div class="text-left space-y-3 my-6"><p><strong class="font-semibold text-white">Open Positions:</strong> ${item.positions}</p></div><p class="text-gray-400">${item.contact}</p></div></div>`; },
            philosophy: item => `<div class="card rounded-lg"><button class="accordion-toggle w-full flex items-center justify-between p-6 text-left"><div class="flex items-center">${item.icon}<h3 class="text-xl font-bold text-white">${item.title}</h3></div><svg class="w-6 h-6 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button><div class="accordion-content px-6"><p class="text-gray-400 py-4">${item.content}</p></div></div>`,
            themes: item => `<div class="card rounded-lg overflow-hidden relative group"><div class="absolute top-2 right-2 space-x-1 admin-controls z-10"><button onclick="openItemModal('themes', '${item.id}')" class="bg-gray-700 p-2 rounded-full hover:bg-accent-yellow text-white hover:text-black"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"></path><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd"></path></svg></button><button onclick="deleteItem('themes', '${item.id}')" class="bg-gray-700 p-2 rounded-full hover:bg-red-500 text-white"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button></div><button class="accordion-toggle w-full flex items-center justify-between p-6 text-left"><h3 class="text-xl font-bold text-white">${item.title}</h3><svg class="w-6 h-6 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button><div class="accordion-content px-6"><div class="py-6 grid md:grid-cols-2 gap-8 items-center"><img src="${item.image[0]}" alt="${item.title}" class="rounded-md object-cover w-full h-64"><p class="text-gray-400">${item.content}</p></div></div></div>`,
            articles: item => `<div class="relative group"><div class="absolute top-0 right-0 space-x-1 admin-controls"><button onclick="openItemModal('articles', '${item.id}')" class="..."></button><button onclick="deleteItem('articles', '${item.id}')" class="..."></button></div><a href="${item.url}" target="_blank" class="block publication-item border-b border-gray-800 pb-4 hover:opacity-80 transition-opacity"><p class="font-semibold text-white">${item.title}</p><p class="text-sm text-gray-400">${item.authors.replace(/(J Kim\*?)/g, '<span class="font-bold text-accent-yellow">$1</span>')}</p><p class="text-xs text-gray-500 mt-1">${item.journal}</p></a></div>`,
            projects: item => `<tr><td class="p-3">${item.sponsor}</td><td class="p-3">${item.name}</td><td class="p-3">${item.period}</td><td class="p-3">${item.budget}</td><td class="p-3"><span class="bg-green-800 text-green-300 text-xs font-medium px-2 py-1 rounded">${item.status}</span></td><td class="p-3 admin-controls"><div class="flex space-x-2"><button onclick="openItemModal('projects', '${item.id}')" class="..."></button><button onclick="deleteItem('projects', '${item.id}')" class="..."></button></div></td></tr>`,
            hardware: item => `<div class="card p-4 rounded-lg relative group"><div class="absolute top-2 right-2 space-x-1 admin-controls"><button onclick="openItemModal('hardware', '${item.id}')" class="..."></button><button onclick="deleteItem('hardware', '${item.id}')" class="..."></button></div><img src="${item.image[0]}" alt="${item.name}" class="rounded-md mb-4"><h4 class="font-bold text-white">${item.name}</h4><p class="text-sm text-gray-400">${item.manufacturer}</p><p class="text-sm text-gray-500">Acquired: ${item.acquired}</p></div>`,
            software: item => `<div class="card p-4 rounded-lg relative group"><div class="absolute top-2 right-2 space-x-1 admin-controls"><button onclick="openItemModal('software', '${item.id}')" class="..."></button><button onclick="deleteItem('software', '${item.id}')" class="..."></button></div><img src="${item.image[0]}" alt="${item.name}" class="rounded-md mb-4"><h4 class="font-bold text-white">${item.name}</h4><p class="text-sm text-gray-400">${item.manufacturer}</p><p class="text-sm text-gray-500">Acquired: ${item.acquired}</p></div>`,
            algorithm: item => `<div class="card p-6 rounded-lg relative group"><div class="absolute top-2 right-2 space-x-1 admin-controls"><button onclick="openItemModal('algorithm', '${item.id}')" class="..."></button><button onclick="deleteItem('algorithm', '${item.id}')" class="..."></button></div><h4 class="text-lg font-bold text-white mb-2">${item.title}</h4><p class="text-gray-400">${item.content}</p></div>`,
            archives: (item, category) => `<div class="card p-4 rounded-lg cursor-pointer relative group" onclick="viewItem('${category}', '${item.id}')"><div class="absolute top-2 right-2 space-x-1 admin-controls"><button onclick="event.stopPropagation(); openItemModal('${category}', '${item.id}')" class="..."></button><button onclick="event.stopPropagation(); deleteItem('${category}', '${item.id}')" class="..."></button></div><p class="text-gray-300"><span class="font-semibold accent-yellow mr-2">${item.title.match(/(\[.*?\])?/)[0] || ''}</span>${item.title.replace(/(\[.*?\])?/, '').trim()}</p></div>`
        };

        function reRender(category) {
            const container = document.getElementById(`${category}-list`) || document.getElementById(`${category}-section`);
            if (!container) return;
            
            let content = '';
            if (category === 'projects') {
                content = `<table class="w-full text-left text-sm"><thead class="border-b border-gray-700 text-gray-300"><tr><th class="p-3">Sponsor</th><th class="p-3">Project Name</th><th class="p-3">Period</th><th class="p-3">Budget</th><th class="p-3">Status</th><th class="p-3 admin-controls">Actions</th></tr></thead><tbody>${appData.projects.map(item => renderFunctions.projects(item)).join('')}</tbody></table>`;
            } else if (category === 'leader' || category === 'recruitment') {
                content = renderFunctions[category](appData[category][0]);
            } else {
                content = appData[category].map(item => {
                    const renderer = renderFunctions[category] || renderFunctions.archives;
                    return renderer(item, category);
                }).join('');
            }
            container.innerHTML = content;

            if (['philosophy', 'themes'].includes(category)) {
                setupAccordions();
            }
            if (['notices', 'news'].includes(category)) {
                updateHomeLists();
            }
        }

        function updateHomeLists() {
            ['news', 'notices'].forEach(category => {
                const homeList = document.getElementById(`home-${category}-list`);
                if (!homeList) return;
                homeList.innerHTML = '';
                appData[category].slice(0, 3).forEach(item => {
                    homeList.innerHTML += renderFunctions.archives(item, category);
                });
            });
        }

        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', () => {
            appData = JSON.parse(JSON.stringify(initialData)); // Deep copy
            document.getElementById('copyright-year').textContent = new Date().getFullYear();
            document.getElementById('copyright-year').addEventListener('click', handleAdminAccess);
            Object.keys(appData).forEach(reRender);
            setupMobileMenu();
            showSection('home', document.querySelector('header nav a'));
        });
    </script>
</body>
</html>
